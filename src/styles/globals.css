@import "tailwindcss/preflight";
@tailwind utilities;

/* Theme transition handling */
:root {
  --transition-duration: 0.3s;
}

/* Apply transition to all elements that could change with theme */
.theme-transition * {
  transition: background-color var(--transition-duration) ease-in-out,
              color var(--transition-duration) ease-in-out,
              border-color var(--transition-duration) ease-in-out,
              box-shadow var(--transition-duration) ease-in-out,
              fill var(--transition-duration) ease-in-out;
}

/* Disable transition during initial page load and theme changes */
.disable-transitions * {
  transition: none !important;
}

/* Theme-specific focus styles */
.dark *:focus-visible {
  outline-color: rgba(var(--color-primary-400), 0.8);
}

*:focus-visible {
  outline-color: rgba(var(--color-primary-500), 0.8);
}

/* Prevent content jumps during scrolling */
html {
  overflow-y: scroll;
}

/* Optimize scrolling performance */
body {
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior-y: none;
  touch-action: manipulation; /* Disable double-tap to zoom */
  -webkit-tap-highlight-color: rgba(0,0,0,0); /* Remove tap highlight on iOS */
}

/* Force hardware acceleration for smoother rendering */
.select-container, 
.dropdown-content,
.product-selector {
  transform: translateZ(0);
  will-change: transform;
  backface-visibility: hidden;
}

/* Ensure dropdowns appear above other content */
.select-popover {
  z-index: 9999 !important;
}

/* Fix stacking context for dropdown containers */
.select-wrapper {
  isolation: isolate;
  position: relative;
}

/* Improved radio buttons for mobile */
[role="radio"] {
  padding: 12px !important;
  border-radius: 8px;
  margin-bottom: 8px;
  border: 1px solid rgba(var(--color-gray-300), 0.8);
  transition: all 0.2s ease;
  position: relative;
  overflow: hidden;
}

[role="radio"][data-selected=true] {
  background-color: rgba(var(--color-primary-500), 0.1);
  border-color: rgb(var(--color-primary-500));
}

[role="radio"][data-selected=true]::after {
  content: '';
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background-color: rgb(var(--color-primary-500));
}

/* Dark mode support */
.dark [role="radio"] {
  border-color: rgba(var(--color-gray-600), 0.8);
}

.dark [role="radio"][data-selected=true] {
  background-color: rgba(var(--color-primary-400), 0.2);
  border-color: rgb(var(--color-primary-400));
}

.dark [role="radio"][data-selected=true]::after {
  background-color: rgb(var(--color-primary-400));
}

/* Extra small screen optimization (iPhone 5 size) */
@media (max-width: 320px) {
  .flex-col-xxs {
    flex-direction: column !important;
  }
  
  .w-full-xxs {
    width: 100% !important;
  }
  
  .mt-4-xxs {
    margin-top: 1rem !important;
  }
  
  /* Condense font sizes on tiny screens */
  h5, .text-base {
    font-size: 0.875rem !important;
  }
  
  /* Stack adjacent inputs on tiny screens */
  .flex-row > div {
    width: 100% !important;
    margin-top: 0.5rem;
  }
  
  .flex-row > div:first-child {
    margin-top: 0;
  }
}

/* Mobile specific enhancements */
@media (max-width: 768px) {
  /* Make buttons and inputs more touch-friendly */
  button, 
  [role="button"],
  input,
  select,
  .select-trigger {
    min-height: 44px; /* Apple's recommended minimum size */
    font-size: 16px !important; /* Prevent iOS zoom on focus */
  }
  
  /* Increase spacing between interactive elements */
  .form-field {
    margin-bottom: 20px;
  }

  /* Add more padding to selectable items */
  [role="option"],
  .select-item {
    padding: 12px !important;
  }
  
  /* Make radio buttons even more tappable on mobile */
  [role="radio"] {
    padding: 16px !important;
    display: block;
    width: 100%;
  }

  /* Fix iOS quirks */
  input, select, textarea {
    font-size: 16px !important; /* Prevents zoom on iOS */
  }

  /* Ensure there's extra space at bottom for scrolling past fixed elements */
  .content-with-fixed-bottom {
    padding-bottom: 70px;
  }
}

/* Feedback for interactive elements */
@media (hover: hover) {
  /* Only apply hover effects on devices that support hover */
  button:hover, [role="button"]:hover {
    opacity: 0.9;
  }
}

/* Print styles */
@media print {
  /* Remove browser headers and footers */
  @page {
    margin: 0.5cm;
    size: auto;
  }
  
  /* Hide unnecessary elements when printing */
  header, footer, nav, .no-print {
    display: none !important;
  }
  
  /* Ensure text is readable when printed */
  body {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
    background-color: white !important;
    color: black !important;
  }
  
  /* Ensure form fields print with visible contents */
  input, textarea, select {
    border: 1px solid #ddd !important;
    background: transparent !important;
  }
}

/* globals.css */
@import "tailwindcss/preflight";
@tailwind utilities;

/* Add responsive design base rules */
@layer base {
  html {
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
  }
  
  body {
    @apply antialiased text-gray-800 bg-gray-50;
  }
  
  /* Improve touch targets on mobile */
  @media (max-width: 640px) {
    button, 
    [role="button"],
    a.btn,
    input[type="button"],
    input[type="submit"] {
      min-height: 44px;
      min-width: 44px;
    }
  }
}

/* Add component specific styles */
@layer components {
  /* Currency value formatting */
  .currency-value {
    @apply whitespace-nowrap font-mono tabular-nums;
  }
  
  /* Responsive tables for mobile */
  .responsive-table {
    @apply w-full overflow-x-auto -mx-4 sm:mx-0;
  }
  
  /* Responsive grid layouts */
  .responsive-grid {
    @apply grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4;
  }
}

/* Print-specific styles */
@media print {
  @page {
    size: letter portrait;
    margin: 0.5in;
  }
  
  html, body {
    width: 100%;
    min-height: 100%;
    margin: 0;
    padding: 0;
    background-color: white !important;
    font-size: 12pt;
  }
  
  body {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
  }
  
  /* Hide non-essential elements */
  header, footer, nav, .no-print, .print\:hidden {
    display: none !important;
  }
  
  /* Ensure content doesn't break across pages */
  tr, td, th, img, h2, h3 {
    page-break-inside: avoid;
  }
  
  h2, h3, h4 {
    page-break-after: avoid;
  }
  
  /* Ensure tables display properly */
  table {
    border-collapse: collapse;
    width: 100%;
  }
  
  /* Improve link display in print */
  a {
    text-decoration: none !important;
    color: inherit !important;
  }
  
  /* Ensure form fields print with visible content */
  input, select, textarea {
    border: 1px solid #ddd;
    background: white !important;
    color: black !important;
  }
  
  /* Fix for Firefox printing transparent backgrounds as black */
  * {
    -webkit-print-color-adjust: exact !important;
    color-adjust: exact !important;
  }
  
  /* Force background colors to show in print */
  .print\:bg-white {
    background-color: white !important;
  }
  
  .print\:bg-gray-50 {
    background-color: #f9fafb !important;
  }
  
  .print\:bg-gray-100 {
    background-color: #f3f4f6 !important;
  }
  
  .print\:bg-gray-200 {
    background-color: #e5e7eb !important;
  }
}
